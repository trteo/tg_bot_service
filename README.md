# Bottec tg bot

Бот-магазина для продажи товаров через Телеграм с использованием встроенной интеграции с ЮКасса для оплаты корзины

## Описание
* Бот будет проверять, подписан ли обращающийся пользователь на ТГ группу и канал при каждом сообщении  
* При перезапуске сервиса память о текущих диалоговых окнах пользователя не теряется
* Пользователь выбирает категорию, подкатегорию товара и сам товар
* После выбора товара пользователь может ознакомиться с информацией о нем и добавить произвольное количество в корзину
* При переходе в корзину и подтверждении ее содержания, пользователь может оплатить товары через ЮКассу
* После оплаты пользователю придет уведомление о принятии в работу заказа

## Основные технологии
**aiogra**, **aiogram_dialog** - для принятия сообщений и управления окнами сообщений \
**Redis** - для хранения состояний диалоговых окон пользователя \
**PostgreSQL** + **SQLAlchemy** - для хранения информации о корзине пользователя и истории его заказов и асинхронных запросов \
**Docker** - универсальный споособ запуска в контейнере

### Env

Переменные окружения берутся из settings/env \
Пример заполненных значений хранится в settings/env.example (все кроме Токена бота)


### Для запуска необходимо

* Создать бота
* Дать боту доступ в [Youkassa](https://yookassa.ru/docs/support/payments/onboarding/integration/cms-module/telegram)
* Добавить в бота в канал и группу ТГ
* Добавить id и ссылки на канал и группу в settings/env
* Прописать конфиг поднятой БД в env (POSTGRES_HOST=gateway.docker.internal если Postgres поднят на устройстве)
либр POSTGRES_HOST=db, если запуск происходит через docker compose 
* Прописать в конфиг токены YouKassa и бота
* Заполнить БД (скрипт запускается при старте админки)
* Запустить

Тестовая карта для ЮКассы - 5555 5555 5555 4444
Дата любая, но еще не наступившая. CVС любой


### Запуск докер контейнера
```commandline
docker build --progress=plain --no-cache -t bot . && \
docker run -it bot
```


##### Разработчик
Тропин Федор \
tg: **@fedorTrop**
